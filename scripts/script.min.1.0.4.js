function sendData(e,t){var n;if(e==="loadCommunity"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadCommunity(e,n,t)},data:{param:"community",max:t.max,comname:t.comname,start:t.start,limit:t.limit,more:t.more,newuser:t.newuser,uid:t.uid,comType:t.comType}}}else if(e==="loadSuggestCommunity"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadSuggestCommunity(e,n,t)},data:{param:"sugcomm"}}}else if(e==="loadTimeline"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadTimeline(e,n,t)},data:{param:"timeline",p:t.t,uid:t.uid,start:t.start,limit:t.limit}}}else if(e==="loadCommunityMembers"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadCommunityMembers(e,n,t)},data:{param:"community",m:t.comname,user:t.uid,start:t.start,limit:t.limit}}}else if(e==="loadSuggestFriends"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadSuggestFriends(e,n,t)},data:{param:"sugfriend"}}}else if(e==="sendFriendRequest"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){sendFriendRequest(e,n,t)},complete:function(e,n){if(t.param!=="Accept Request")$(t.target).html("")},data:{param:t.param,user:t.user,resp:t.resp?t.resp:""}}}else if(e==="loadGossbag"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadGossbag(e,n,t)},data:{param:"gossbag",start:t.start,limit:t.limit,update:true}}}else if(e==="loadWink"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadWink(e,n,t)},data:{param:"loadWink",start:t.start,limit:t.limit}}}else if(e==="loadGossComment"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadGossComment(e,n,t)},data:{param:"loadGossComment",start:t.start,limit:t.limit}}}else if(e==="loadGossFrq"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadGossFrq(e,n,t)},data:{param:"loadGossFrq",start:t.start,limit:t.limit}}}else if(e==="loadGossFrq"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadGossFrq(e,n,t)},data:{param:"loadGossFrq",start:t.start,limit:t.limit}}}else if(e==="loadGossPost"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadGossPost(e,n,t)},data:{param:"loadGossPost",start:t.start,limit:t.limit}}}else if(e==="loadNotificationCount"){n={beforeSend:function(){},success:function(e,n,r){loadNotificationCount(e,n,t)},data:{param:"notifSum",update:false}}}else if(e==="loadNavMessages"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadNavMessages(e,n,t)},data:{param:"messages",cw:t.cw?t.cw:"",timestamp:t.timestamp}}}else if(e==="loadNewMessage"){n={beforeSend:function(){return false},success:function(e,n,r){loadNewMessage(e,n,t)},data:{param:"messages",cw:t.cw?t.cw:"",timestamp:t.timestamp}}}else if(e==="loadNewGossbag"){return;n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadNewGossbag(e,n,t)},data:{param:"gossbag",min:true,update:true}}}else if(e==="loadFriends"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadFriends(e,n,t)},data:{param:"friends",start:t.start?t.start:0,limit:t.limit?t.limit:10,uid:t.uid}}}else if(e==="inviteFriends"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){inviteFriends(e,n,t)},data:{param:"inviteFriends",comid:t.comId}}}else if(e==="acceptDeclineComInvitation"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){acceptDeclineComInvitation(e,n,t)},data:{param:"inviteFriends",comid:t.comId,response:t.response}}}else if(e==="loadPost"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadPost(e,n,t)},data:{param:"loadPost",cid:t.comid,pid:t.pid,start:t.start,limit:t.limit,append:t.append}}}else if(e==="deletePost"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){deletePost(e,n,t)},data:{param:"deletePost",postId:t.post_id}}}else if(e==="deleteComment"){n={before:function(){showuidfeedback(t)},success:function(e,n,r){deleteComment(e,n,t)},data:{param:"deleteComment",cid:t.cid}}}else if(e==="loadComment"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){loadComment(e,n,t)},data:{param:"loadComment",pid:t.post_id}}}else if(e==="leaveJoinCommunity"){n={beforeSend:function(){},success:function(e,n,r){leaveJoinCommunity(e,n,t)},data:{param:t.param,comid:t.comid,helve:t.comHelve,name:t.comName}}}else if(e==="likePost"){n={beforeSend:function(){showuidfeedback(t)},success:function(e,n,r){likePost(e,n,t)},data:{param:"likePost",action:t.action,postId:t.postId}}}else if(e==="logError"){n={data:{param:t.param,statusCode:t.jqXHR.status,statusText:t.jqXHR.statusText,readyState:t.jqXHR.readyState,responseText:t.jqXHR.responseText,textStatus:t.textStatus,errorThrown:t.errorThrown}}}$.ajax(n)}function showuidfeedback(e){if(e.loadImage){$(e.target).html("<center><img src='images/loading.gif' style='border:none' /></center>")}return true}function loadTimeline(e,t,n){if(!e.error){var r="",i="";var s=e.length;$.each(e,function(e,t){if(t.type==="post"){r+='<div class="timeline-news-single">'+'<a class= "fancybox " rel="'+t.id+'" href="'+(t.photo.nophoto?t.photo.alt:t.photo.original)+'">'+'<div class="timeline-news-profile-pic">'+'<img onload="OnImageLoad(event);" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'</div></a><p><a href="user/'+t.username+'">'+(t.sender_id===readCookie("user_auth")?"You":t.firstname.concat(" ",t.lastname))+'</a> posted to <a href="'+t.unique_name+"/"+t.id+'">'+t.name+"</a></p>"+'<p class="timeline-time timeago" title="'+t.time+'">'+t.time+"</p>";if(t.post_photo){r+='<p class="timeline-photo-upload">';$.each(t.post_photo,function(e,n){r+='<a class="fancybox" rel="gallery'+t.id+'"  href="'+n.original+'" rel="group"><img src="'+n.thumbnail+'"></a>'});r+='</p><div class="clear"></div>'}if(t.post){r+="<p>"+linkify(t.post.length>200?t.post.substring(0,200)+'<span style="display:none" id="continuereading-'+t.id+'">'+t.post.substring(200)+'</span> <a id="continue-'+t.id+'">continue reading...</a>':t.post)+"</p>"+'<!--<p class="post-meta"><span id="post-new-comment-show-'+t.id+'" class=""><span class="icon-16-comment"></span>Comment(20)</span>'+'<span class="post-meta-gossout"><span class="icon-16-share"></span><a class="fancybox " id="inline" href="#share-123456">Share(20)</a></span></p>--><div class="clear"></div></div>'}else{r+="<p></p>"+'<!--<p class="post-meta"><span id="post-new-comment-show-'+t.id+'" class=""><span class="icon-16-comment"></span>Comment(20)</span>'+'<span class="post-meta-gossout"><span class="icon-16-share"></span><a class="fancybox " id="inline" href="#share-123456">Share(20)</a></span></p>--><div class="clear"></div></div>'}if(t.post)if(t.post.length>200){if(i!==""){i+=","}i+="#continue-"+t.id}}else if(t.type==="comcrea"){r+='<div class="timeline-news-single">'+'<a class= "fancybox " rel="profilePix" href="'+(t.photo.nophoto?t.photo.alt:t.photo.original)+'">'+'<div class="timeline-news-profile-pic">'+'<img src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"></div></a>'+'<p><a href="user/'+t.username+'">'+(t.creator_id===readCookie("user_auth")?"You":t.firstname.concat(" ",t.lastname))+'</a> created a new <a href="'+t.unique_name+'">Community</a></p>'+'<p class="timeline-time timeago" title="'+t.time+'">'+t.time+'</p><div class="community-meta">'+'<a class="fancybox" rel="gallery'+t.id+'"  href="'+t.pix+'" rel="group"><img src="'+t.thumbnail100+'"></a>'+'<h3><a href="'+t.unique_name+'">'+t.name+"</a></h3>"+"<p>"+t.description+"</p>"+(t.isAmember?"":'<p><a class="joinCom" id="joinCom-'+t.id+'">Join</a></p>')+'</div><div class="clear"></div></div>';if(!t.isAmember){if(i!==""){i+=","}i+=".joinCom"}}});if(n.loadMore){if(r!==""){$(n.target).append(r);if(s<10){$("#loadMoreImg,#loadMoreNotifDiv").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else{$("#loadMoreNotifDiv").show();$(".loadMoreTimeLine").attr("timeLine",parseInt($(".loadMoreTimeLine").attr("timeLine"))+10);$("#loadMoreImg").hide()}}else{humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg,#loadMoreNotifDiv").hide()}}else{if(s>=20)$("#loadMoreNotifDiv").show();$(n.target).html(r)}prepareDynamicDates();$(".timeago").timeago();if(i!==""){$(i).click(function(){showOption(this)})}}else{$(n.target).html('<div class="timeline-news-single"><p>Oops!... no post is attached to this user</p></div>')}}function loadWink(e,t,n){var r="",i="",s="",o;if(!e.error){o=e.bag.length;$.each(e.bag,function(e,t){r+='<div class="individual-notification-box"><p><span class="icon-16-eye"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-notification-text">'+'<h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Winked you</div></div><hr><p>'+'<a class="all-notifications-actions winkIgnore" id="winkIgnore-text-n-'+t.id+"-"+t.sender_id+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="all-notifications-actions wink-text" id="wink-text-n-'+t.id+"-"+t.sender_id+'"><span class="icon-16-eye"></span>Wink back</a>'+"</p></div>";s+=s===""?".winkIgnore,.wink-text":",.winkIgnore,.wink-text"});if(n.status==="append"){$(n.target).append(r);$("#loadMoreImg").hide();if(o===10){$("#loadMoreNotifDiv").show();$(".loadMoreGossContent").attr("wink",parseInt($(".loadMoreGossContent").attr("wink"))+limit);if(!$("#wink-notification-icon").hasClass("showmore"))$("#wink-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv,#loadMoreImg").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(r);if(o===10){$("#loadMoreNotifDiv").show();if(!$("#wink-notification-icon").hasClass("showmore"))$("#wink-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv,#loadMoreImg").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}$(s).click(function(){showOption(this)});prepareDynamicDates();$(".timeago").timeago()}else{if(n.status==="append"){humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg").hide();$("#loadMoreNotifDiv").hide();$("#wink-notification-icon").addClass("noResult")}else{r="Oops! You have no unviewed winks.";$(n.target).html(r);$("#loadMoreNotifDiv").hide();$("#wink-notification-icon").addClass("noResult")}}}function loadGossPost(e,t,n){var r="",i;if(!e.error){i=e.bag.length;$.each(e.bag,function(e,t){r+='<div class="individual-notification-box">'+'<p><span class="icon-16-pencil"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="all-notification-text"><h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-comment">posts "'+(t.post.length>50?t.post.substring(0,50)+"...":t.post)+'" in <a href="'+t.unique_name+'">'+t.name+"</a></div></div><hr><p>"+'<a href="'+t.unique_name+"/"+t.id+'" class="all-notifications-actions"><span class="icon-16-dot"></span>View</a></p></div>'});if(n.status==="append"){$(n.target).append(r);$("#loadMoreImg").hide();if(i===10){$("#loadMoreNotifDiv").show();$(".loadMoreGossContent").attr("posts",parseInt($(".loadMoreGossContent").attr("posts"))+limit);if(!$("#post-notification-icon").hasClass("showmore"))$("#post-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(r);if(i===10){$("#loadMoreNotifDiv").show();if(!$("#post-notification-icon").hasClass("showmore"))$("#post-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv,#loadMoreImg").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}prepareDynamicDates();$(".timeago").timeago()}else{if(n.status==="append"){humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg").hide();$("#loadMoreNotifDiv").hide();$("#post-notification-icon").addClass("noResult")}else{r="Oops! You have no post notification.";$(n.target).html(r);$("#loadMoreNotifDiv").hide()}}}function loadGossComment(e,t,n){var r="",i="",s="",o;if(!e.error){o=e.bag.length;$.each(e.bag,function(e,t){r+='<div class="individual-notification-box">'+'<p><span class="icon-16-comment"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="all-notification-text"><h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Commented on '+(t.isMyPost?"on your post":"a post")+" in "+t.name+"</div>"+'<div class="all-notifications-comment">"'+(t.comment.length>50?t.comment.substring(0,50)+"...":t.comment)+'"</div></div><hr><p>'+'<a href="'+t.unique_name+"/"+t.post_id+'" class="all-notifications-actions"><span class="icon-16-dot"></span>View</a></p></div>'});if(n.status==="append"){$(n.target).append(r);$("#loadMoreImg").hide();if(o===10){$("#loadMoreNotifDiv").show();$(".loadMoreGossContent").attr("comment",parseInt($(".loadMoreGossContent").attr("comment"))+limit);if(!$("#comment-notification-icon").hasClass("showmore"))$("#comment-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(r);if(o===10){$("#loadMoreNotifDiv").show();if(!$("#comment-notification-icon").hasClass("showmore"))$("#comment-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}prepareDynamicDates();$(".timeago").timeago()}else{if(n.status==="append"){humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg").hide();$("#loadMoreNotifDiv").hide();$("#comment-notification-icon").addClass("noResult")}else{r="Oops! You have no comment notification.";$(n.target).html(r);$("#loadMoreNotifDiv").hide()}}}function loadGossFrq(e,t,n){var r="",i="",s="",o;if(!e.error){o=e.bag.length;$.each(e.bag,function(e,t){r+='<div class="individual-notification-box"><p><span class="icon-16-user-add"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-notification-text">'+'<h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Wants To Add You</div></div><hr><p>'+'<a class="all-notifications-actions frqIgnore" id="frqIgnore-text-n-'+t.username1+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="all-notifications-actions accept-frq" id="accept-frq-text-n-'+t.username1+'"><span class="icon-16-checkmark"></span>Accept</a>'+"</p></div>";s+=".accept-frq";s+=",.frqIgnore"});if(n.status==="append"){$(n.target).append(r);$("#loadMoreImg").hide();$(n.target).html(r);if(o===10){$(".loadMoreGossContent").attr("frq",parseInt($(".loadMoreGossContent").attr("frq"))+limit);$("#loadMoreNotifDiv").show();if(!$("#frq-notification-icon").hasClass("showmore"))$("#frq-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv,#loadMoreImg").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(r);if(o===10){if(!$("#comment-notification-icon").hasClass("showmore"))$("#comment-notification-icon").addClass("showmore");$("#loadMoreNotifDiv").show()}else{$("#loadMoreNotifDiv,#loadMoreImg").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}$(s).click(function(){showOption(this)});prepareDynamicDates();$(".timeago").timeago()}else{if(n.status==="append"){humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg").hide();$("#loadMoreNotifDiv").hide();$("#frq-notification-icon").addClass("noResult")}else{r="Oops! You have no pending friend request.";$(n.target).html(r);$("#frq-notification-icon").addClass("noResult");$("#loadMoreNotifDiv").hide()}}}function loadGossbag(e,t,n){if(!e.error){var r="",i="",s="",o="";var u=e.length;$.each(e,function(e,t){if(t.type==="frq"){if(n.target==="#individual-notification-box-a"){r+='<div class="individual-notification-box"><p><span class="icon-16-user-add"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-notification-text">'+'<h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Wants To Add You</div></div><hr><p>'+'<a class="all-notifications-actions frqIgnore" id="frqIgnore-text-n-'+t.username1+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="all-notifications-actions accept-frq" id="accept-frq-text-n-'+t.username1+'"><span class="icon-16-checkmark"></span>Accept</a>'+"</p></div>";i+=".accept-frq";i+=",.frqIgnore"}else{r+='<div class="individual-notification"><p><span class="icon-16-user-add"></span>'+'<span class="float-right timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="notification-text"> <p class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></p>"+'<p>wants to add you as friend</p></div><div class="clear"></div><hr>'+'<span id="frqOption-'+t.id+'"><a class="notification-actions frqIgnore" id="frqIgnore-text-'+t.username1+'">Ignore</a>'+'<a class="notification-actions accept-frq" id="accept-frq-text-'+t.username1+'">Accept</a></span>'+'<div class="clear"></div></div>';i+=".accept-frq";i+=",.frqIgnore"}}else if(t.type==="TW"){if(n.target==="#individual-notification-box-a"){r+='<div class="individual-notification-box"><p><span class="icon-16-eye"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-notification-text">'+'<h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Winked you</div></div><hr><p>'+'<a class="all-notifications-actions winkIgnore" id="winkIgnore-text-n-'+t.id+"-"+t.sender_id+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="all-notifications-actions wink-text" id="wink-text-n-'+t.id+"-"+t.sender_id+'"><span class="icon-16-eye"></span>Wink back</a>'+"</p></div>";i+=i===""?".winkIgnore,.wink-text":",.winkIgnore,.wink-text"}else{r+='<div class="individual-notification"><p><span class="icon-16-eye"></span>'+'<span class="float-right timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="notification-text"> <p class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></p>"+'<p>winked you</p></div><div class="clear"></div><hr>'+'<span id="winkOption-'+t.id+'"><a class="notification-actions winkIgnore" id="winkIgnore-text-'+t.id+"-"+t.sender_id+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="notification-actions wink-text" id="wink-text-'+t.id+"-"+t.sender_id+'"><span class="icon-16-eye"></span>Wink back</a></span>'+'<div class="clear"></div></div>';i+=i===""?".winkIgnore,.wink-text":",.winkIgnore,.wink-text"}}else if(t.type==="comment"){if(n.target==="#individual-notification-box-a"){r+='<div class="individual-notification-box">'+'<p><span class="icon-16-comment"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="all-notification-text"><h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">Commented on '+(t.isMyPost?"on your post":"a post")+' in <a href="'+t.unique_name+'">'+t.name+"</a></div>"+'<div class="all-notifications-comment">"'+(t.comment.length>50?t.comment.substring(0,50)+"...":t.comment)+'"</div></div><hr><p>'+'<a href="'+t.unique_name+"/"+t.post_id+'" class="all-notifications-actions"><span class="icon-16-dot"></span>View</a></p></div>'}else{r+='<div class="individual-notification"><p><span class="icon-16-comment"></span><span class="float-right timeago" title="'+t.time+'">'+t.time+"</span></p>"+'<img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="notification-text">'+'<p class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></p><p>commented on "+(t.isMyPost?"on your post":"a post")+' in <a href="'+t.unique_name+'">'+t.name+"</a></p>"+'<p>"'+(t.comment.length>31?t.comment.substring(0,31)+"...":t.comment)+'"</p></div><div class="clear"></div><hr>'+'<a href="'+t.unique_name+"/"+t.post_id+'" class="notification-actions" title="'+t.name+'">View</a><div class="clear"></div></div>'}}else if(t.type==="post"){if(n.target==="#individual-notification-box-a"){r+='<div class="individual-notification-box">'+'<p><span class="icon-16-pencil"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="all-notification-text"><h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-comment">posts "'+(t.post.length>50?t.post.substring(0,50)+"...":t.post)+'" in <a href="'+t.unique_name+'">'+t.name+"</a></div></div><hr><p>"+'<a href="'+t.unique_name+"/"+t.id+'" class="all-notifications-actions"><span class="icon-16-dot"></span>View</a></p></div>'}else{r+='<div class="individual-notification viewed-notification"><p><span class="icon-16-pencil"></span>'+'<span class="float-right timeago" title="'+t.time+'"> '+t.time+' </span></p><img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="notification-text"> <p class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></p>"+'<p>posts "'+(t.post.length>50?t.post.substring(0,50)+"...":t.post)+'"</p><p>in <a href="'+t.unique_name+'">'+t.name+'</a></p></div><div class="clear"></div><hr><a href="'+t.unique_name+"/"+t.id+'" class="notification-actions">View</a>'+'<div class="clear"></div></div>'}}else if(t.type==="IV"){if(n.target==="#individual-notification-box-a"){r+='<div class="individual-notification-box"><p><span class="icon-16-earth"></span><span class="all-notifications-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-notification-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-notification-text">'+'<h3><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></h3>"+'<div class="all-notifications-message">invites you to join <a href="'+t.unique_name+'">'+t.name+'</a></div></div><hr><p id="invitationtarget">'+'<a class="all-notifications-actions invitationIgnore" id="invitationIgnore-text-'+t.comid+'"><span class="icon-16-cross"></span>Ignore</a>'+'<a class="all-notifications-actions invitation-text" id="invitation-text-'+t.comid+'"><span class="icon-16-earth"></span>Join</a>'+"</p></div>";i+=i===""?".invitationIgnore,.invitation-text":",.invitationIgnore,.invitation-text"}else{r+='<div class="individual-notification viewed-notification"><p><span class="icon-16-earth"></span>'+'<span class="float-right timeago" title="'+t.time+'"> '+t.time+' </span></p><img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'">'+'<div class="notification-text"> <p class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a></p><p>invites you to join</p>"+'<p><a href="'+t.unique_name+'">'+t.name+'</a></p></div><div class="clear"></div><hr><span id="invitationtarget"><a class="notification-actions invitationIgnore" id="invitationIgnore-text-n-'+t.comid+'">Ignore</a>'+'<a class="notification-actions invitation-text" id="invitation-text-n-'+t.comid+'">Join</a></span><div class="clear"></div></div>';i+=i===""?".invitationIgnore,.invitation-text":",.invitationIgnore,.invitation-text"}}});if(n.status==="append"){$(n.target).append(r);$("#loadMoreImg").hide();if(u===10){$("#loadMoreNotifDiv").show();$(".loadMoreGossContent").attr("all",parseInt($(".loadMoreGossContent").attr("all"))+limit);if(!$("#all-notification-icon").hasClass("showmore"))$("#all-notification-icon").addClass("showmore")}else{$("#loadMoreNotifDiv").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(r);if(u===10){if(!$("#all-notification-icon").hasClass("showmore"))$("#all-notification-icon").addClass("showmore");$("#loadMoreNotifDiv").show()}else{$("#loadMoreNotifDiv").hide()}}$(i).click(function(){showOption(this)});prepareDynamicDates();$(".timeago").timeago();$(".notifications").jScrollPane({verticalDragMinHeight:12,verticalDragMaxHeight:12})}else{if(e.error){if(n.status==="append"){humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreImg").hide();$("#all-notification-icon").addClass("noResult");$("#loadMoreNotifDiv").hide()}else{$(n.target).html('<div class="individual-notification"><div class="notification-text"><p>You don\'t have any notifications yet</p></div><div class="clear"></div><hr><div class="clear"></div></div>')}}}}function loadNewMessage(e,t,n){}function loadNewGossbag(e,t,n){if(!e.error){var r=document.URL.split("/"),i="",s="";var o=$.inArray("home",r);e.reverse();if(i!==""){$(i).click(function(){showOption(this)})}prepareDynamicDates();$(".timeago").timeago()}}function inviteFriends(e,t,n){var r="";if(!e.error){$.each(e,function(e,t){r+='<option value="'+t.id+'">'+t.firstname.concat(" ",t.lastname)+"</option>"});if(r!==""){var i='<select data-placeholder="Select friend(s)" class="chzn-select" multiple style="width:350px;" name="user[]" id="user_callup"><option value=""></option>'+r+'</select><li><input id="sendBtn" type="submit" class="button submit" name="param" value="Send Invitation" /><span id="messageStatus"></span></li>';$(n.target).html(i);$(".chzn-select").chosen()}else{$(n.target).html("You do not have any friend to send invitation to")}}else if(e.error){$(n.target).html("You do not have any friend to send invitation to")}}function acceptDeclineComInvitation(e,t,n){if(!e.error){var r="";if(e.status===true){r="Your request was successful!";humane.log(r,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else{if(n.response===true){r="Your accept request was not successful!";humane.log(r,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"})}else{r="Your ignore request was not successful!";humane.log(r,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"})}}$(n.target).html(r)}else{humane.log(e.error.message,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"})}}function sendFriendRequest(e,t,n){if(!e.error){if(n.param==="Unfriend"){$("#aside-friend-"+n.user).hide();humane.log("Unfriend action successful!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else if(n.param==="Send Friend Request"){$("#aside-sugfriend-"+n.user).hide();$(".unfriend-"+n.user).removeClass("loaded");$("#unfriend-"+n.user+"-text").html("Cancel Request");humane.log("Friend request action successful!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else if(n.param==="Cancel Request"){$(".unfriend-"+n.user).removeClass("loaded");$("#unfriend-"+n.user+"-text").html("Send Friend Request");humane.log("Friend request canceled successful!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else if(n.param==="Accept Request"){$(n.target).removeClass("clicked");$(n.target).html("Unfriend");humane.log("Friend request accepted successful!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else if(n.param==="wink"){$(n.target).removeClass("loaded");humane.log("Wink successful",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else if(n.param==="ignoreWink"){$(n.target).removeClass("loaded");humane.log("Wink ignored successful",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}}function loadNavMessages(e,t,n){var r="";var i;if(n.cw!==undefined){$("#messageTitle").html('<a href="messages/'+n.cw+'">'+e.cwn+' <span class="icon-16-chat"></span></a><hr>');var s=document.getElementById("new-message-btn");s.parentNode.removeChild(s);i=e.photo;$("#msgHeader").html('<div class="compose-box"><form method="POST" action="tuossog-api-json.php" id="conForm"><textarea required placeholder="Compose a message" name="message" id="msg"></textarea>'+'<input type="submit" class="submit button float-right" name="param" value="Send Message">'+'<!--<button class="button float-right hint hint--left" data-hint ="Upload Image"><span class="icon-16-camera"></span></button>-->'+'<script>$("#conForm").ajaxForm({beforeSubmit: function() {},success: function(responseText, statusText, xhr, $form) {'+"$('"+n.target+'\').html(\'<div class="individual-message-box"><p><span class="all-messages-time timeago" title="\' + responseText.m_t + \'"> \' + responseText.m_t + \' </span></p><img class= "all-messages-image" src="\' + (responseText.photo.nophoto ? responseText.photo.alt : responseText.photo.thumbnail50)+\'"><div class="all-messages-text"><a href=""><h3>\' + responseText.sender_name + \' </h3></a><div class="all-messages-message"><span class="icon-16-reply"></span> <p>\' + nl2br(htmlencode($("#msg").val())) + \'</p><!--<br><span class="post-meta-delete"><span class="icon-16-trash"></span><span>Delete</span></span>--></div></div></div>\'+$(\''+n.target+'\').html());$("#msg").val("");prepareDynamicDates();$(".timeago").timeago();},'+'complete: function(response, statusText, xhr, $form) {if (response.error) {$("#messageStatus").html(response.error.message);} else {$("#messageStatus").html("");}},data: {uid: "'+readCookie("user_auth")+'",user:"'+n.cw+'"}});</script>'+'</form><div class="clear"></div></div><div class="float-right"><span class="icon-16-arrow-left"></span><a href="messages" class="back">Back to messages</a></div>');if(e.conversation){$.each(e.conversation,function(e,t){r+='<div class="individual-message-box"><p><span class="all-messages-time timeago" title="'+t.time+'"> '+t.time+" </span>"+'</p><img class= "all-messages-image" src="'+(i.nophoto?i.alt:t.s_username===n.cw?i[t.s_username].thumbnail50:i[t.s_username].thumbnail50)+'"><div class="all-messages-text">'+'<a href=""><h3>'+(t.s_username===n.cw?t.s_firstname.concat(" ",t.s_lastname):t.s_firstname.concat(" ",t.s_lastname))+" </h3></a>"+'<div class="all-messages-message">'+(n.uid===t.sender_id?'<span class="icon-16-reply"></span>':"")+" <p>"+t.message+'</p><!--<br><span class="post-meta-delete"><span class="icon-16-trash"></span><span>Delete</span></span>--></div></div></div>'})}}else{$.each(e,function(e,t){if(n.target==="#message-individual-notification"){if(!t.code){r+='<div class="individual-notification'+(t.status==="R"?" viewed-notification":"")+'"><p><span class="float-right timeago" title="'+t.time+'"> '+t.time+' </span><div class="clear"></div>'+'</p><img class= "notification-icon" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="notification-text">'+'<p class="name">'+t.firstname.concat(" ",t.lastname)+'</p><p><!--<span class="icon-16-reply">--></span>'+t.message.substring(0,30)+(t.message.lenght>29?"...":"")+"</p>"+'</div><div class="clear"></div><hr><a class="notification-actions" href="messages/'+t.username+'">View</a><div class="clear"></div></div>'}else{r+='<div class="individual-notification"><p><span class="float-right"></span></p><div class="notification-text"><p>You don\'t have any messages yet.</p></div><div class="clear"></div><hr></div>'}}else{if(!t.code){r+='<div class="individual-message-box"><p><span class="all-messages-time timeago" title="'+t.time+'"> '+t.time+" </span></p>"+'<img class= "all-messages-image" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"><div class="all-messages-text">'+'<a href=""><h3>'+t.firstname.concat(" ",t.lastname)+"</h3></a>"+'<div class="all-messages-message">'+t.message.substring(0,250)+(t.message.lenght>249?"...":"")+"</div></div><hr><p>"+'<!--<a class="all-messages-actions"><span class="icon-16-cross"></span>Delete</a>-->'+'<a href="messages/'+t.username+'" class="all-messages-actions"><span class="icon-16-reply"></span>Reply</a></p></div>'}else{r+='<div class="individual-message-box"><div class="all-messages-text"><h3>No messages</h3></div></div>'}}})}$(n.target).html(r);prepareDynamicDates();$(".timeago").timeago()}function htmlencode(e){return e.replace(/[&<>"']/g,function(e){return"&"+{"&":"amp","<":"lt",">":"gt",'"':"quot","'":"#39"}[e]+";"})}function loadNotificationCount(e,t,n){if(e.gb>0){var r=$("#gossbag-individual-notification").html();if(r!==""){if(r==='<div class="individual-notification"><div class="notification-text"><p>Gossbag Empty</p></div><div class="clear"></div><hr><div class="clear"></div></div>'){sendData("loadNewGossbag",{target:"#gossbag-individual-notification",status:"replace"})}else if(r!=="<center><img src='images/loading.gif' style='border:none' /></center>"){sendData("loadNewGossbag",{target:"#gossbag-individual-notification",status:"prepend"})}}$("#gb-number").html(e.gb)}else{$("#gb-number").html(" ")}if(e.msg>0){var r=$("#message-individual-notification").html();if(r!==""){if(r==='<div class="individual-message-box"><div class="all-messages-text"><h3>No messages</h3></div></div>'){sendData("loadNewMessage",{target:"#message-individual-notification",status:"replace",mt:readCookie("m_t")})}else if(r!=="<center><img src='images/loading.gif' style='border:none' /></center>"){sendData("loadNewMessage",{target:"#message-individual-notification",status:"prepend",mt:readCookie("m_t")})}}$("#msg-number").html(e.msg)}else{$("#msg-number").html(" ")}if(e.gb+e.msg>0){document.title="("+(e.gb+e.msg)+") "+n.title}else{document.title=n.title}setTimeout(function(){sendData("loadNotificationCount",n)},3e4)}function loadCommunityMembers(e,t,n){var r="",i="";if(!e.error){$.each(e,function(e,t){r+='<a class= "fancyboxMem" rel="members" id="inline" href="#'+t.username+'">'+'<div class= "friends-thumbnails"><img onload="OnImageLoad(event);" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail150)+'"></div>'+'<div style="display:none"><div id="'+t.username+'"><div class="aside-wrapper">'+'<div class="profile-pic"><img class="holdam" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail150)+'"></div><table><tr><td></td><td>'+'<h3><a href="user/'+t.username+'" onclick="location = \'user/'+t.username+"'\">"+t.firstname.concat(" ",t.lastname)+'</a></h3></td></tr><tr><td><span class="icon-16-map"></span></td><td class="profile-meta">'+(t.location===""?"Not Set":t.location)+"</td></tr>"+'<tr><td><span class="icon-16-'+(t.gender==="M"?"male":"female")+'"></span></td><td class="profile-meta">'+(t.gender==="M"?"Male":"Female")+"</td></tr>"+'<tr><td><span class="icon-16-dot"></span></td><td class="profile-meta"><a href="user/'+t.username+'" onclick="location = \'user/'+t.username+"'\">See Profile</a></td></tr>"+'</table><div class="clear"></div><div class="profile-summary profile-summary-width"><div class="profile-summary-wrapper">'+'<a href="user/'+t.username+'" onclick="location = \'user/'+t.username+'\'"><p class="number">'+t.ministat.pc+' </p> <p class="type">Posts</p></a></div>'+'<div class="profile-summary-wrapper"><a href="communities"><p class="number">'+t.ministat.cc+' </p> <p class="type">Communities</p></a></div>'+'<div class="profile-summary-wrapper"><a href="friends"><p class="number">'+t.ministat.fc+' </p> <p class="type">Friends</p></a></div>'+'<div class="clear"></div></div><div class="clear"></div>';if(t.isAfriend!==true&&t.isAfriend!=="me"){r+='<div class="profile-meta-functions button unfriend-'+t.id+'" friend_id="'+t.id+'"><span class="icon-16-checkmark"></span><span id="unfriend-'+t.id+'-text">Send Friend Request</span></div>'}if(t.isAfriend!=="me"){r+='<div class="profile-meta-functions button" id="wink-'+t.id+'"><span class="icon-16-eye"></span> Wink</div>';if(i!=="")i+=",";i+="#wink-"+t.id;i+=",.unfriend-"+t.id}if(t.isAfriend===true){r+='<div class="profile-meta-functions button"><a href="messages/'+t.username+'"><span class="icon-16-mail"></span> Send Message</a></div>'}r+='<div class="clear"></div></div></div></div></a>'});if(e.length>20){$("#showAllCommem").html('<span class="icon-16-dot"></span><a href="friends">Show all</a>')}else{$("#showAllCommem").html("")}$(n.target).html(r);$(".fancyboxMem").fancybox({openEffect:"none",closeEffect:"none",minWidth:400});$(i).click(function(){showOption(this)})}else{$(n.target).html("0 Member")}}function loadCommunity(e,t,n){if(!e.error){var r="",i="",s;if(n.loadAside){if(n.uid===0){$("#joinleave").remove()}$.each(e,function(e,t){$("#commTitle").html("<a href='"+n.comname+"'>"+(t.verified==="1"?'<img src="images/gossout-verified.png" class="verified-community" <img src="images/gossout-verified.png" class="verified-community" title="Verified Community">':"")+t.name+"</a>");$("#commDesc").html(t.description.length>250?nl2br(linkify(t.description.substring(0,250)))+"<span style='display:none' id='comdisplayMoreDesc'>"+nl2br(linkify(t.description.substring(250)))+"</span>"+" <a id='commViewMoreDesc'>view more...</a>":nl2br(linkify(t.description)));$(".openChatButton,#joinleave").attr("rel",t.id);$(".openChatButton").attr("comname",t.name).attr("compix",t.thumbnail150);if(t.description){$("#metaDescription").attr("content",t.description.substring(0,160))}else{$("#metaDescription").attr("content","Start or join existing communities/interests on Gossout and start sharing pictures and videos. People use Gossout search, Discover and connect with communities")}if($("#communityTag").length){var o="";if(t.category){if(t.category.length>0){var u=t.category.split(",");$.each(u,function(e,t){o+="<li data-value='"+t+"'>"+t+"</li>"})}}$("#communityTag").html(o);$("#communityTag").tagit({select:true})}var a=t.description.split();a.unshift(n.comname+","+t.name);$("#metaKeywords").attr("content",a.join());$("#commUrl").html("<a href='"+n.comname+"'>www.gossout.com/"+n.comname+"</a>");$("#comType").html((t.type==="Private"?'<span class="icon-16-lock"></span>':"")+t.type);$("#joinleave").html(t.isAmember==="true"?'<span class="icon-16-star-empty"></span> <span id="joinleave-text">Leave</span>':'<span class="icon-16-star"></span> <span id="joinleave-text">Join</span>');$("#mem_count").html(t.mem_count);$("#post_count").html(t.post_count);if(readCookie("user_auth")===0){$("#joinleave").remove()}if(t.isAmember==="true"&&!n.settings){if(t.creator_id===readCookie("user_auth")){$("#otherCommOption").html('<div class=" button profile-button" id="loadCommore">More<span class="icon-16-arrow-down"></span>'+'<div class="more-container" id="pop-up-community-more"><div class="more"><ul>'+'<li id="inviteMemBtn"><a class="displayX" href="#inviteDisplay"><span class="icon-16-user-add"></span> Invite Members<div style="display:none">'+'<div id="inviteDisplay" class="registration" style="width: 800"><h3>Invite Friends</h3><hr/>'+'<form id="inviteForm" method="POST" action="tuossog-api-json.php"><ul>'+'<li><span id="toUserInput"></span></li>'+"</ul></form></div></div></a></li>"+"<hr>"+'<li><a href="community-settings/'+n.comname+'"><span class="icon-16-cog"></span> Settings</a></li>'+"</ul></div></div></div>")}else{$("#otherCommOption").html('<a class=" button profile-button displayX" id="inviteMemBtn"  href="#inviteDisplay"><span class="icon-16-user-add"></span> Invite Friends</a>'+'<div style="display:none"><div id="inviteDisplay" class="registration" style="width: 800"><h3>Invite Friends</h3><hr/>'+'<form id="inviteForm" method="POST" action="tuossog-api-json.php"><ul>'+'<li><span id="toUserInput"></span></li>'+"</ul></form></div></div>")}$(".displayX").fancybox({openEffect:"none",closeEffect:"none",minWidth:500,afterClose:function(){$("#inviteMemBtn").removeClass("Open")}});$("#inviteForm").ajaxForm({beforeSubmit:function(){var e=$("#user_callup").val();if(e===null){humane.log("Select at least a friend first",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"});return false}else{return true}},success:function(e,t,n,r){if(!e.error){if(e.status===true){$.fancybox.close();humane.log("Your invitation was sent successfully",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"})}else{humane.log("Your invitation was not sent successfully due to invalid parameters",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}}else{humane.log(e.error.message,{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}},complete:function(e,t,n,r){},data:{uid:readCookie("user_auth"),comid:$("#joinleave").attr("rel")}})}else if(n.settings){document.getElementById("com-img").src=t.thumbnail150;$(".helve").val(n.comname);$("#commName").val(t.name);$("#commDescription").val(br2nl(t.description));$(".creator_field").val(t.creator_id);if(t.type==="Private"){$("#privacy").prop("checked",true)}if(t.enableMemberPost==="0"){$("#enablePost").prop("checked",true)}}document.getElementById("commPix").src=t.thumbnail150;r=t.id;if(t.isAmember==="true"){s="true";if(t.creator_id===readCookie("user_auth")){i+='<div class="posts"><h1>'+t.name+'</h1><div class="post-box">'+'<form method="POST" action="tuossog-api-json.php" id="com-'+t.id+'" enctype="multipart/form-data">'+'<textarea required placeholder="Post to '+t.name+'" name="post" id="post'+t.id+'"></textarea>'+'<input type="submit" class="submit button float-right" value="Post" id="postBtn">'+'<input type="file" onchange="$(\'#filesSelected\').html(this.files.length + (this.files.length > 1 ? \' files selected\' : \' file selected\'))" name="photo[]" multiple style="position: absolute;left: -9999px;" id="uploadInput"/>'+'<input type="hidden" name="comid[]" value="'+r+'"/>'+'<div class="button hint hint--left  float-right" data-hint="Upload image" id="uploadImagePost"><span class="icon-16-camera"></span></div>'+'<div class="progress" style="display:none"><div class="bar"></div ><div class="percent">0%</div></div><div id="filesSelected" class="float-right" style="font-size: 12px; color: #99c53d"></div>'+'</form><div class="clear"></div></div><span id="loadPost"></span><hr/><div class="button" style="float:left;display:none;" id ="commMorePostDiv"><a commPost="20"  class="commMorePost" id="commMorePost">Load more > ></a></div><div id="loadMoreImg" style="display:none;">  <img src="images/loading.gif"/></div></div>'}else{if(t.enableMemberPost!=="0"){i+='<div class="posts"><h1>'+t.name+'</h1><div class="post-box">'+'<form method="POST" action="tuossog-api-json.php" id="com-'+t.id+'" enctype="multipart/form-data">'+'<textarea required placeholder="Post to '+t.name+'" name="post" id="post'+t.id+'"></textarea>'+'<input type="submit" class="submit button float-right" value="Post" id="postBtn">'+'<input type="file" onchange="$(\'#filesSelected\').html(this.files.length + (this.files.length > 1 ? \' files selected\' : \' file selected\'))" name="photo[]" multiple style="position: absolute;left: -9999px;" id="uploadInput"/>'+'<input type="hidden" name="comid[]" value="'+r+'"/>'+'<div class="button hint hint--left  float-right" data-hint="Upload image" id="uploadImagePost"><span class="icon-16-camera"></span></div>'+'<div class="progress" style="display:none"><div class="bar"></div ><div class="percent">0%</div></div><div id="filesSelected" class="float-right" style="font-size: 12px; color: #99c53d"></div>'+'</form><div class="clear"></div></div><span id="loadPost"></span><hr/><div class="button" style="float:left;display:none;" id ="commMorePostDiv"><a commPost="20"  class="commMorePost" id="commMorePost">Load more > ></a></div><div id="loadMoreImg" style="display:none;">  <img src="images/loading.gif"/></div></div>'}else{i+='<div class="posts"><h1>'+t.name+'</h1><hr/><span id="loadPost"></span>\n<hr/><div class="button" style="float:left;display:none;" id ="commMorePostDiv"><a commPost="20"  class="commMorePost" id="commMorePost">Load more > ></a></div><div id="loadMoreImg" style="display:none;">  <img src="images/loading.gif"/></div></div>'}}}else{i+='<div class="posts"><h1>'+t.name+'</h1><hr/><span id="loadPost"></span>\n<hr/><div class="button" style="float:left;display:none;" id ="commMorePostDiv"><a commPost="20"  class="commMorePost" id="commMorePost">Load more > ></a></div><div id="loadMoreImg" style="display:none;">  <img src="images/loading.gif"/></div></div>'}});if(i!==""){$(n.target).html(i);if(!n.settings){sendData("loadPost",{target:"#loadPost",uid:readCookie("user_auth"),comid:r,pid:n.loadPost,start:0,limit:20,loadImage:true})}if(s==="true"){$("#uploadImagePost,#loadCommore,#inviteMemBtn,#commViewMoreDesc").click(function(){if(this.id==="uploadImagePost"){$("#uploadInput").focus().trigger("click")}else{showOption(this)}});var o=$(".bar");var u=$(".percent");if(!n.settings){$("#com-"+r).ajaxForm({beforeSubmit:function(e,t,n){if($("#uploadInput").val()!==""){$(".progress").show();var r="0%";o.width(r);u.html(r)}$("#postBtn").prop("disabled",true)},uploadProgress:function(e,t,n,r){var i=r+"%";o.width(i);u.html(i)},success:function(e,t,n,i){var s="100%";o.width(s);u.html(s);if(e.id!==0){var a=$("#post"+r).val();var f='<div class="post"><div class="post-content"><p>'+linkify(nl2br(htmlencode(a)))+"</p>";if(e.post_photo){$.each(e.post_photo,function(t,n){f+='<a class="fancybox" rel="gallery'+e.id+'"  href="'+n.original+'" rel="group"><img src="'+n.thumbnail+'"></a>'})}f+='<hr><h3 class="name"><img onload="OnImageLoad(event);" class="post-profile-pic" src="'+e.photo+'"><a href="user/">'+e.name+"</a>"+'<div class="float-right"><span class="post-time"><span class="icon-16-comment"></span><span id="numComnt-'+e.id+'">0</span> </span>'+'<span class="post-time"><span class="icon-16-clock"></span><span class="timeago" title="'+e.time+'">'+e.time+"</span></span>"+'</div></h3></div><hr><div class="post-meta">'+'<span id="post-new-comment-show-'+e.id+'" class=""><span class="icon-16-comment"></span>Comment </span>'+'<div class="post-comments" id="post-comments-'+e.id+'">'+'</div><div class="post-new-comment" id="post-new-comment-'+e.id+'">'+'<form method="POST" autocomplete="off" action="tuossog-api-json.php?pid='+e.id+'" id="post-new-comment-form-'+e.id+'"><!--<img class="post-thumb" src="images/snip.jpg">--><span><input type="text" class="comment-field" required placeholder="Add comment..." name="comment" id="input-'+e.id+'"/></span>'+'<input type="submit" class="submit" value="Comment"><div class="clear"></div></form></div></div></div>';$("#loadPost").prepend(f);$("#post_count").html(parseInt($("#post_count").html())+1);$("#noPost-text").hide();$("#post-new-comment-show-"+e.id).click(function(){showOption(this)});$("#post-new-comment-form-"+e.id).ajaxForm({beforeSubmit:function(e,t,n){var r=t.attr("id").lastIndexOf("-")+1;var i=t.attr("id").substring(r)},success:function(e,t,n,r){var i=r.attr("id").lastIndexOf("-")+1;var s=r.attr("id").substring(i);if(e.id!==0){var o=$("#input-"+s).val();$("#post-comments-"+s).html($("#post-comments-"+s).html()+'<div class="post-comment"><img class="post-thumb" src="'+(e.photo.nophoto?e.photo.alt:e.photo.thumbnail50)+'"><h4 class="name">'+e.name+'</h4><span class="post-time timeago" title="'+e.time+'">'+e.time+"</span><p>"+nl2br(htmlencode(o))+'</p><div class="clear"></div></div>');prepareDynamicDates();$(".timeago").timeago();$("#numComnt-"+s).html(parseInt($("#numComnt-"+s).html())+1)}$("#post-new-comment-form-"+s).clearForm()},complete:function(e,t,n,r){},data:{param:"comment",uid:readCookie("user_auth")}});prepareDynamicDates();$(".timeago").timeago()}$("#com-"+r).clearForm()},complete:function(e,t,n,r){$(".progress").hide(500);$("#postBtn").prop("disabled",false)},data:{param:"post",uid:readCookie("user_auth")}})}}else{$("#commViewMoreDesc").click(function(){showOption(this)});$("#otherCommOption").hide()}}else{$(n.target).html('<div class="posts"></div>')}}else{var a=e.length;$.each(e,function(e,t){if(n.target==="#aside-community-list"){i+='<div class="community-listing"><span><a href="'+t.unique_name+'">'+t.name+"</a></span></div><hr>"}else if(n.target==="#all-communities-list"||n.target==="#my-communities-list"||n.target===".community-box"){i+='<div class="community-box-wrapper" id="comDiv-'+t.id+'"><div class="community-image">'+'<img onload="OnImageLoad(event);" src="'+t.thumbnail150+'">'+'</div><div class="community-text"><div class="community-name">'+'<a href="'+t.unique_name+'">'+(t.verified==="1"?'<img src="images/gossout-verified.png" class="verified-community" title="Verified Community">':"")+'<span id="comUnique-'+t.id+'" rel="'+t.unique_name+'">'+t.name+"</span>"+'</a> </div><hr><div class="details">'+(t.description.length>100?br2nl(t.description).substring(0,100)+"...":br2nl(t.description))+'</div><div class="members">'+t.type+'</div><div class="members">'+t.mem_count+" "+(t.mem_count>1?"Members":"Member")+'</div><div class="members">'+t.post_count+" "+(t.post_count>1?"Posts":"Post")+"</div></div>"+(readCookie("user_auth")!==0?t.isAmember=="false"?'<a class="float-right joinCom" id="joinCom-'+t.id+'">Join</a>':"":'<div style="float:right;font-size:0.8em;"><a href="login">Login</a> Or <a href="signup-personal">Signup</a> to join</div>')+'<div class="clear"></div></div>'}});if(n.more){if(i!==""){$(n.target).append(i);$("#loader1").hide()}if(a<n.limit){$("#loadMoreComm,#loader1").hide();if(n.newuser){$("#exploreMoreComm").hide()}humane.log("Oops! You've got it all!",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"})}else{if(!n.newuser){$("#loadMoreComm").show();if(n.comType==="allCom"){$("#loadMoreComm").attr("allcomm",parseInt($("#loadMoreComm").attr("allcomm"))+n.limit)}if(n.comType==="myCom"){$("#loadMoreComm").attr("mycomm",parseInt($("#loadMoreComm").attr("mycomm"))+n.limit)}}else{$("#exploreMoreComm").attr("newcomm",parseInt($("#loadMoreComm").attr("newcomm"))+n.limit).show()}}}else{if(i!=="")$(n.target).html(i);if(a===n.limit){$("#loadMoreComm").show();n.newuser?$("#exploreMoreComm").show():$("#exploreMoreComm").hide()}}$(".joinCom").click(function(){showOption(this)})}}else{if(n.loadAside){if(e.error.code){var f=window.location+"";var l=f.substring(f.length-1);if(l==="/"){f=f.substring(0,f.length-1)}}}else{if(n.target==="#aside-community-list"){$(n.target).html('Oops! Seems you do not belong to any Community; Join Communities of your interest to get even more on Gossout. <a href="home">Start here!</a>')}else if(n.target==="#my-communities-list"){if(n.more){humane.log("Oops! You've got it all!",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loader1,#loadMoreComm").hide()}else{currentCom="allCom";start=0;$("#loadMoreComm").show();$("#suggestion-list,#my-communities-list").hide();$("#all-communities-list").show();$("#suggestions,#my-communities").removeClass("active");$("#all").addClass("active");sendData("loadCommunity",{target:"#all-communities-list",comType:"allCom",loadImage:true,max:true,start:start,limit:limit})}}if(n.newuser===false){humane.log("Oops! You've got it all!",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loader1,#loadMoreComm").hide()}else{}}}}function leaveJoinCommunity(e,t,n){if(!e.error){if(n.param==="Join"){$("#comDiv-"+n.comid).remove();var r='<div class="community-listing"><span style="color:#777777;">'+'<a href="'+n.comHelve+'">'+n.comName+"</a></span></div><hr>";var i=$("#aside-community-list").children("div");var s=$("#aside-community-list").children("hr");if(i.length>0){$("#aside-community-list").prepend(r);if(i.length==5){s[s.length-1].remove();i[i.length-1].remove()}}else{if(i.length==0){$("#aside-community-list").html(r)}}$("#cc").html(parseInt($("#cc").html())+1);humane.log("You have successfully joined this community",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"})}else{humane.log("You have successfully left this community",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"});location.reload()}}else{humane.log(e.error.message,{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}}function loadSuggestCommunity(e,t,n){if(!e.error){var r="";$.each(e,function(e,t){if(!n.aside){r+='<div class="community-box-wrapper">';r+='<div class="community-image"><img onload="OnImageLoad(event);" src="'+t.pix+'"></div>';r+='<div class="community-text"><div class="community-name">'+'<a href="'+t.unique_name+'">'+(t.verified==="1"?'<img src="images/gossout-verified.png" class="verified-community" title="Verified Community">':"")+t.name+'</a> </div><hr><p class="community-privacy"><div class="details">'+(t.description.length>100?br2nl(t.description).substring(0,100)+"...":br2nl(t.description))+'</div><div class="members">'+t.type+'</div><div class="members">'+t.mem_count+" "+(t.mem_count>1?"Members":"Member")+'</div><div class="members">'+t.post_count+" "+(t.post_count>1?"Posts":"Post")+'</div></div><div class="clear"></div></div>'}else{if(e>0){r+="<hr>"}r+='<div class="community-listing"><span><a href="'+t.unique_name+'">'+t.name+"</a></span></div>"}});$(n.target).html(r)}else{if(e.error.code===404){if(!n.aside){$("#pageTitle").html("Suggested Community")}if(!n.more)$(n.target).html("<p>Opps! We cannot suggest community to you at the moment. <a href='create-community'>Start your own community</a>.</p>");else{humane.log("Oops! You've got it all!",{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$("#pageTitle").html("Communities");humane.log(e.error.message,{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}}}function likePost(e,t,n){var r=readCookie("user_auth");$(n.target).hide();if(e.status){$("#likeAction-"+n.postId).html(e.action==="Like"?"Unlike":"Like");$("#likeCount-"+n.postId).html(e.countLike.count);var i="";var s=e.countLike.count;if(s>0)$.each(e.countLike.likeBy,function(e,t){if(i!==""){if(s===2){i+=" and "}else{i+=","}}if(r===t.user_id){i+="You"}else{i+=t.fullname}});if(e.countLike.count>3){i+=" and "+(e.countLike.count-3)+" more people liked this"}else if(s===0){i+=""}else{i+=" liked this"}$("#likeAction-showCount-"+n.postId).attr("title",i)}else{$("#likeCount-"+n.postId).html("")}$(".hideLikeCount#likeAction-showCount-"+n.postId).show()}function loadPost(e,t,n){if(!e.error){var r=readCookie("user_auth");var i="";var s="",o="";var u=e.length;$.each(e,function(e,t){if(t.post){i+='<div class="post" id="post-'+t.id+'"><div class="post-content"><p>'+(t.post.length>200?nl2br(linkify(t.post.substring(0,200)))+'<span style="display:none" id="continuereading-'+t.id+'">'+nl2br(linkify(t.post.substring(200)))+'</span> <a id="continue-'+t.id+'">continue reading...</a>':nl2br(linkify(t.post)))+"</p>"}else{i+='<div class="post" id="post-'+t.id+'"><div class="post-content"><p></p>'}if(t.post_photo){$.each(t.post_photo,function(e,n){i+='<a class="fancybox" rel="gallery'+t.id+'"  href="'+n.original+'" rel="group"><img src="'+n.thumbnail+'"></a>'})}i+='<hr><h3 class="name"><img onload="OnImageLoad(event);" class="post-profile-pic" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail45)+'"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+"</a>"+'<div class="float-right">';if(t.likeCount.count===0){i+='<span class="post-time '+t.id+' hideLikeCount" id="likeAction-showCount-'+t.id+'"><span class="icon-16-heart post='+t.id+'"></span><span id="likeCount-'+t.id+'">'+t.likeCount+"</span> </span> "}else{var u="";var a=t.likeCount.count;$.each(t.likeCount.likeBy,function(e,t){if(u!==""){if(a===2){u+=" and "}else{u+=", "}}if(r===t.user_id){u+="You"}else{u+=t.fullname}});if(a>3){u+=" and "+(a-3===1?a-3+" other person":a-3+" more people")+" liked this"}else{if(a===0){u+=""}else{u+=" liked this"}}i+='<span class="post-time '+t.id+'" id="likeAction-showCount-'+t.id+'" title="'+u+'"><span class="icon-16-heart post='+t.id+'"></span><span id="likeCount-'+t.id+'">'+t.likeCount.count+"</span> </span> "}i+='<span class="post-time"><span class="icon-16-comment"></span><span id="numComnt-'+t.id+'">'+t.numComnt+"</span> </span> "+'<span class="post-time"><span class="icon-16-clock"></span><span class="timeago" title="'+t.time+'">'+t.time+"</span></span>"+'</div></h3></div><hr><div class="post-meta">';if(n.uid!==0){i+='<span class="post-meta-delete like-icon"><span class="icon-16-heart like-item" post='+t.id+'></span><hold class="likeAction" id="likeAction-'+t.id+'">'+(t.isLike?"Unlike":"Like")+"</hold></span>&nbsp"}i+='<span id="post-new-comment-show-'+t.id+'" class=""><span class="icon-16-comment"></span>Comment </span>';if(n.uid===0){i+='<span class="post-meta-gossout"><span class="icon-16-dot"></span><a href="login">Login</a> or <a href="signup-personal">sign-up</a> to add posts or comments</span>'}if(n.uid===t.sender_id){i+='<span class="post-meta-delete" id="deletePost-'+t.id+'"><span class="icon-16-trash"></span>Delete</span>  <span class="likeLoader" id="likeLoader-'+t.id+'" style="float:right;margin-top:-7px;"></span>'}i+='<div class="post-comments" id="post-comments-'+t.id+'">'+'</div><div class="post-new-comment" id="post-new-comment-'+t.id+'">';if(n.uid!==0){i+='<form method="POST" autocomplete="off" action="tuossog-api-json.php?pid='+t.id+'" id="post-new-comment-form-'+t.id+'"><!--<img class="post-thumb" src="images/snip.jpg">--><span><input type="text" class="comment-field" required placeholder="Add comment..." name="comment" id="input-'+t.id+'"/></span>'+'<input type="submit" class="submit" value="Comment"><div class="clear"></div></form>'}i+="</div></div></div>";if(e>0){s+=",";o+=","}s+="#post-new-comment-show-"+t.id;o+="#post-new-comment-form-"+t.id;if(t.post)if(t.post.length>200){s+=",#continue-"+t.id}if(n.uid===t.sender_id){s+=",#deletePost-"+t.id}});if(n.append){$(n.target).append(i);if(u<10){$("#commMorePostDiv").hide();humane.log("Oops! You've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}}else{$(n.target).html(i);if(u<20){$("#commMorePostDiv").hide()}else{$("#commMorePostDiv").show();$("#commMorePostDiv").click(function(){var e=parseInt($("#commMorePost").attr("commpost"));$("#loadMoreImg").show();sendData("loadPost",{target:"#loadPost",uid:readCookie("user_auth"),comid:n.comid,start:e,limit:10,loadImage:false,append:true});$("#commMorePost").attr("commpost",parseInt($("#commMorePost").attr("commpost"))+10)})}}$(".fancybox").fancybox({openEffect:"none",closeEffect:"none"});prepareDynamicDates();$(".timeago").timeago();$(o).ajaxForm({beforeSubmit:function(e,t,n){var r=t.attr("id").lastIndexOf("-")+1;var i=t.attr("id").substring(r)},success:function(e,t,n,r){var i=r.attr("id").lastIndexOf("-")+1;var o=r.attr("id").substring(i);if(e.id!==0){var u=$("#input-"+o).val();$("#post-comments-"+o).append('<div class="post-comment" id="comment-'+e.id+'"><div class="post-thumb"><img onload="OnImageLoad(event);" src="'+(e.photo.nophoto?e.photo.alt:e.photo.thumbnail50)+'"></div><h4 class="name">'+e.name+'</h4><span class="post-time timeago" title="'+e.time+'">'+e.time+"</span><p>"+linkify(nl2br(htmlencode(u)))+'<hr><span class="post-meta-delete" id="deleteComment-'+e.id+"_"+o+'"><span class="icon-16-trash"></span>Delete</span></p><div class="clear"></div></div>');s="#deleteComment-"+e.id+"_"+o;prepareDynamicDates();$(".timeago").timeago();$("#numComnt-"+o).html(parseInt($("#numComnt-"+o).html())+1);$(s).click(function(){showOption(this)})}$("#post-new-comment-form-"+o).clearForm()},complete:function(e,t,n,r){},data:{param:"comment",uid:readCookie("user_auth")}});$(s).click(function(){showOption(this)});$(".hideLikeCount").hide();$(".like-icon").click(function(){var e=$(this).children(".like-item").attr("post");var t="#likeLoader-"+e;var n=$(this).children(".likeAction").html();sendData("likePost",{target:t,action:n,loadImage:true,postId:e})})}else{if(n.append){humane.log("Oops! You've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else{$(n.target).html('<div class="post" id="noPost-text"><div class="post-content"><p>No Post Found.</p></div></div>')}$("#commMorePostDiv").hide()}$("#loadMoreImg").hide()}function deletePost(e,t,n){if(!e.error){if(e.status){$(n.target).hide();humane.log("Post deleted!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});if(parseInt($.trim($("#post_count").html()))){if(parseInt($.trim($("#post_count").html()))>0){$("#post_count").html(parseInt($.trim($("#post_count").html()))-1)}}}else{$("#deletePost-"+n.post_id).removeClass("clicked");humane.log("Post was not deleted...try again later",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"})}}else{humane.log(e.error.message,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"});$("#deletePost-"+n.post_id).removeClass("clicked")}}function deleteComment(e,t,n){if(!e.error){if(e.status){$(n.target).hide();humane.log("Comment deleted!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});if(parseInt($.trim($("#numComnt-"+n.postId).html()))){if(parseInt($.trim($("#numComnt-"+n.postId).html()))>0){$("#numComnt-"+n.postId).html(parseInt($.trim($("#numComnt-"+n.postId).html()))-1)}}}else{$("#deleteComment-"+n.post_id).removeClass("clicked");humane.log("Comment was not deleted...try again later",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"})}}else{humane.log(e.error.message,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"});$("#deleteComment-"+n.post_id).removeClass("clicked")}}function loadComment(e,t,n){if(!e.error){var r="",i="";$.each(e,function(e,t){r+='<div class="post-comment" id="comment-'+t.id+'"><div class="post-thumb"><img onload="OnImageLoad(event);" src="'+(t.photo.nophoto?t.photo.alt:t.photo.thumbnail50)+'"> </div><h4 class="name"><a href="user/'+t.username+'">'+t.firstname.concat(" ",t.lastname)+'</a></h4><span class="post-time timeago" title="'+t.time+'">'+t.time+"</span><p>"+linkify(t.comment);if(n.user===t.sender_id){r+='<hr><span class="post-meta-delete" id="deleteComment-'+t.id+"_"+n.post_id+'"><span class="icon-16-trash"></span>Delete</span>';if(e>0&&i!==""){i+=","}if(n.user===t.sender_id){i+="#deleteComment-"+t.id+"_"+n.post_id}}r+='</p><div class="clear"></div></div>'});$(n.target).html(r);prepareDynamicDates();$(".timeago").timeago();if(i!==""){$(i).click(function(){showOption(this)})}}else{$(n.target).html("")}}function loadFriends(e,t,n){if(!e.error){var r="",i="",s="",o=e.length;$.each(e,function(t,o){if(n.target==="#aside-friends-list"){if(n.friendPage){s+='<div class="individual-friend-box"><a class= "fancyboxAlert" id="inline" href="#'+o.username+'">'+'<div class="friend-image"><img onload="OnImageLoad(event);"  src="'+(o.photo.nophoto?o.photo.alt:o.photo.thumbnail50)+'"></div><div class="friend-text">'+'<div class="friend-name">'+o.firstname.concat(" ",o.lastname)+"</div>"+'<div class="friend-location">'+o.location+"</div></div>"+'<div style="display:none"><div id="'+o.username+'"><div class="aside-wrapper"><div class="profile-pic"><img class="holdam" src="'+(o.photo.nophoto?o.photo.alt:o.photo.thumbnail150)+'"></div>'+'<table><tr><td></td><td><h3><a href="user/'+o.username+'" onclick="location = \'user/'+o.username+"'\">"+o.firstname.concat(" ",o.lastname)+"</a></h3></td></tr>"+'<tr><td><span class="icon-16-map"></span></td><td class="profile-meta"> '+o.location+"</td></tr>"+'<tr><td><span class="icon-16-'+(o.gender==="M"?"male":"female")+'"></span></td><td class="profile-meta">'+(o.gender==="M"?"Male":"Female")+"</td></tr>"+'<tr><td><span class="icon-16-dot"></span></td><td class="profile-meta"><a href="user/'+o.username+'" onclick="location = \'user/'+o.username+"'\">See Profile</a> </td></tr>"+'</table><div class="clear"></div><div class="profile-summary profile-summary-width"><div class="profile-summary-wrapper">'+'<a href="user/'+o.username+'" onclick="location = \'user/'+o.username+'\'"><p class="number">'+o.ministat.pc+' </p> <p class="type">Posts</p></a></div>'+'<div class="profile-summary-wrapper"><a href="communities"><p class="number">'+o.ministat.cc+' </p> <p class="type">Communities</p></a></div>'+'<div class="profile-summary-wrapper"><a href="friends"><p class="number">'+o.ministat.fc+' </p> <p class="type">Friends</p></a></div>'+'<div class="clear"></div></div><div class="clear"></div>'+'<div class="profile-meta-functions button" id="wink-f-'+o.id+'"><span class="icon-16-eye"></span> Wink</div>'+'<div class="profile-meta-functions button"><a href="messages/'+o.username+'"><span class="icon-16-mail"></span> Send Message</a></div>'+'<div class="profile-meta-functions button unfriend-'+o.id+'" friend_id="'+o.id+'"><span class="icon-16-checkmark"></span> <span class="unfriend-f-'+o.id+'-text">Unfriend</a></div><span id="loadImage-'+e.id+'"></span>'+'<div class="clear"></div></div></div></div></a></div>';i+=".unfriend-"+o.id;i+=",#wink-f-"+o.id}r+='<a class= "fancyboxAlert" id="aside-friend-'+o.id+'" href="#'+o.username+'">'+'<div class= "friends-thumbnails"><img onload="OnImageLoad(event);" src="'+(o.photo.nophoto?o.photo.alt:o.photo.thumbnail150)+'"></div>'+'<div style="display:none"><div id="'+o.username+'"><div class="aside-wrapper">'+'<div class="profile-pic"><img  src="'+(o.photo.nophoto?o.photo.alt:o.photo.thumbnail150)+'"></div><table><tr><td></td><td>'+'<h3><a href="user/'+o.username+'" onclick="location = \'user/'+o.username+"'\">"+o.firstname.concat(" ",o.lastname)+'</a></h3></td></tr><tr><td><span class="icon-16-map"></span></td><td class="profile-meta">'+o.location+"</td></tr>"+'<tr><td><span class="icon-16-'+(o.gender==="M"?"male":"female")+'"></span></td><td class="profile-meta">'+(o.gender==="M"?"Male":"Female")+"</td></tr>"+'<tr><td><span class="icon-16-dot"></span></td><td class="profile-meta"><a href="user/'+o.username+'" onclick="location = \'user/'+o.username+"'\">See Profile</a> </td></tr></table>"+'<div class="clear"></div><div class="profile-summary profile-summary-width"><div class="profile-summary-wrapper">'+'<a href="user/'+o.username+'" onclick="location = \'user/'+o.username+'\'"><p class="number">'+o.ministat.pc+' </p> <p class="type">Posts</p></a></div>'+'<div class="profile-summary-wrapper"><a href="communities"><p class="number">'+o.ministat.cc+' </p> <p class="type">Communities</p></a></div>'+'<div class="profile-summary-wrapper"><a href="friends"><p class="number">'+o.ministat.fc+' </p> <p class="type">Friends</p></a></div>'+'<div class="clear"></div></div>'+'<div class="clear"></div><div class="profile-meta-functions button" id="wink-'+o.id+'"><span class="icon-16-eye"></span> Wink</div>'+'<div class="profile-meta-functions button"><a href="messages/'+o.username+'"><span class="icon-16-mail"></span> Send Message</a></div>'+'<div class="profile-meta-functions button unfriend-'+o.id+'" friend_id="'+o.id+'"><span class="icon-16-cross"></span> <span class="unfriend-'+o.id+'-text">Unfriend</span></div><span id="loadImage-'+e.id+'"></span>'+'<div class="clear"></div></div></div></div></a>';if(t>0||i!==""){i+=","}i+=".unfriend-"+o.id;i+=",#wink-"+o.id}else{if(n.target==="#toUserInput"){r+='<option value="'+o.id+'">'+o.firstname.concat(" ",o.lastname)+"</option>"}}});if(n.target==="#toUserInput"){var u='<select data-placeholder="Select friend(s)" class="chzn-select" multiple style="width:350px;" name="user[]" id="user_callup"><option value=""></option>'+r+"</select>";$(n.target).html(u);if(n.inviteMemBtn){$(".chzn-select").chosen()}else{$(".chzn-select").chosen({max_selected_options:1})}}else{if(!n.individualFriend)$(n.target).html(r);$(".fancyboxAlert").fancybox({openEffect:"none",closeEffect:"none",minWidth:400});if(n.friendPage){if(s!==""){if(n.individualFriend){$(n.friendPage).append(s);$("#loadMoreFrnd").attr("frnd",parseInt($("#loadMoreFrnd").attr("frnd"))+10);if(o<10){$("#loadMoreFrndDiv,#loader1").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"})}else{$("#loadMoreFrndDiv").show();$("#loader1").hide()}}else{$(n.friendPage).html(s);if(o<18){$("#loadMoreFrndDiv").hide()}else{$("#loadMoreFrndDiv").show()}}}}$(i).click(function(){showOption(this)})}}else{if(e.error.code===404){if(n.target!=="#aside-friends-list"){if(n.target==="#toUserInput"){$(n.target).html("You cannot send any message now since you do not have any friend");$("#msg,#sendBtn,#msgLabel,#toLabel").hide()}else{$(n.target).html("<p>Opps! We cannot suggest friends to you at the moment. <a href='communities'>Join a community</a> to increase your chances.</p>")}}else{if(!n.individualFriend){$(n.target).html("No Friends found!")}else{$("#loader1").hide();humane.log("Opps! you've got it all!",{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-success"});$("#loadMoreFrndDiv").hide()}}}else{$("#pageTitle").html("Communities");humane.log(e.error.message,{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}}}function loadSuggestFriends(e,t,n){var r="";if(!e.error){var i="";$.each(e,function(e,t){i+='<div class="individual-friend-box" id="aside-sugfriend-'+t.id+'"><a class= "fancyboxAlert" href="#'+t.username+'"><div class="friend-image">';if(t.photo.id){i+='<img onload="OnImageLoad(event);" src = "'+(t.photo.thumbnail50===""?t.photo.original:t.photo.thumbnail50)+'" >'}else{i+='<img onload="OnImageLoad(event);" src = "'+t.photo.alt+'" >'}i+='</div><div class="friend-text"><div class="friend-name">'+t.firstname.concat(" ",t.lastname)+"</div>"+'<div class="friend-location">'+t.location+"</div></div>";i+='<div style="display:none"><div id="'+t.username+'"><div class="aside-wrapper">';if(t.photo.id){i+='<div class="profile-pic"><img class="holdam" src = "'+(t.photo.thumbnail150===""?t.photo.original:t.photo.thumbnail150)+'"></div>'}else{i+='<div class="profile-pic"><img class="holdam" src = "'+t.photo.alt+'" ></div>'}i+='<div class="clear"></div><table><tr><td></td><td><h3><a href="user/'+t.username+'" onclick="location = \'user/'+t.username+"'\">"+t.firstname.concat(" ",t.lastname)+"</a></h3></td></tr>"+'<tr><td><span class="icon-16-map"></span></td><td class="profile-meta"> '+(t.location!==""?t.location:"Location not set")+"</td></tr>"+'<tr><td><span class="icon-16-'+(t.gender==="M"?"male":"female")+'"></span></td><td class="profile-meta"> '+(t.gender==="M"?"Male":"Female")+"</td></tr>"+'<tr><td><span class="icon-16-dot"></span></td><td class="profile-meta"><a href="user/'+t.username+'" onclick="location = \'user/'+t.username+"'\">See Profile</a> </td></tr>"+'</table><div class="profile-summary profile-summary-width"><div class="profile-summary-wrapper">'+'<a href=""><p class="number">'+t.ministat.pc+' </p> <p class="type">Posts</p></a></div>'+'<div class="profile-summary-wrapper"><a href="communities"><p class="number">'+t.ministat.cc+' </p> <p class="type">Communities</p></a></div>'+'<div class="profile-summary-wrapper"><a href="friends"><p class="number">'+t.ministat.fc+' </p> <p class="type">Friends</p></a></div>'+'<div class="clear"></div></div>'+'<button class="profile-meta-functions button unfriend-'+t.id+'" friend_id="'+t.id+'"><span class="icon-16-user-add"></span> <span class="unfriend-'+t.id+'-text">Send Friend Request</span></button><span id="loadImage-'+t.id+'"></span>'+'<div class="clear"></div></div></div></div>';i+="</a></div>";if(e>0){r+=","}r+=".unfriend-"+t.id});$(n.target).html(i);$(".fancyboxAlert").fancybox({openEffect:"none",closeEffect:"none",minWidth:250});$(r).click(function(){showOption(this)})}else{if(e.error.code===404){$(n.target).html("<p>Opps! We cannot suggest friends to you at the moment. <a href='communities'>Join a community</a> to increase your chances.</p>")}else{$("#pageTitle").html("Communities");humane.log(e.error.message,{timeout:2e4,clickToClose:true,addnCls:"humane-jackedup-error"})}}}function manageError(e,t,n){var r="";if(t==="timeout"){r="Network timeout."}else if(t==="parsererror"){r="Opps! something critical just happened...Our team will fix this soon "}if(r!=="")humane.log(r,{timeout:3e3,clickToClose:true,addnCls:"humane-jackedup-error"});option={param:"logError",jqXHR:e,textStatus:t,errorThrown:n};if(t!=="timeout"&&t!==""&&e.readyState!==0&&e.statusCode===504)sendData("logError",option)}function showOption(e){var t;if(e.id==="show-suggested-friends"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open");$("#"+e.id).html("Suggest Friends")}else{$("#"+e.id).addClass("Open");$("#"+e.id).html("Hide Suggested Friends")}t={complete:function(){if(!$(this).hasClass("loadedContent")){sendData("loadSuggestFriends",{target:"#aside-suggest-friends",loadImage:true});$(this).addClass("loadedContent")}}};$("#suggested-friends").toggle(t)}else if(e.id==="show-suggested-community"){if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open");$("#"+e.id).html("Suggest Community")}else{$("#"+e.id).addClass("Open");$("#"+e.id).html("Hide Suggested Community")}t={complete:function(){if(!$(this).hasClass("loadedContent")){sendData("loadSuggestCommunity",{target:"#aside-suggest-community",loadImage:true,aside:true});$(this).addClass("loadedContent")}}};$("#suggested-community").toggle(t)}else if(e.id==="gossbag-text"||e.id==="gossbag-close"){$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);t={complete:function(){if($("#"+e.id).hasClass("Open")){if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("loadGossbag",{target:"#gossbag-individual-notification",loadImage:true})}}},duration:0};if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open")}else{$("#"+e.id).addClass("Open")}$("#pop-up-gossbag").toggle(t)}else if(e.id==="messages-text"||e.id==="messages-close"){$("#pop-up-gossbag").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);t={complete:function(){if($("#"+e.id).hasClass("Open")){if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("loadNavMessages",{target:"#message-individual-notification",loadImage:true})}}},duration:0};if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open")}else{$("#"+e.id).addClass("Open")}$("#pop-up-message").toggle(t)}else if(e.id==="user-actions"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-more").toggle(false);$("#pop-up-user-actions").toggle()}else if(e.id==="user-more-option"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle()}else if(e.id==="show-full-profile"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open");$("#"+e.id).html("View Full Profile")}else{$("#"+e.id).addClass("Open");$("#"+e.id).html("Hide Full Profile")}$("#full-profile-data").toggle()}else if(e.id==="search"||e.id==="search-close"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);$("#full-profile-data").toggle(false);$("#pop-up-search").toggle()}else if(e.id==="new-message-btn"){if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open")}else{$("#"+e.id).addClass("Open")}if($("#"+e.id).hasClass("Open")){if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("loadFriends",{target:"#toUserInput",loadImage:true})}}}else if(e.id==="loadCommore"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);$("#full-profile-data").toggle(false);$("#pop-up-search").toggle(false);$("#pop-up-community-more").toggle()}else if(e.id==="changePassAnchor"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);$("#full-profile-data").toggle(false);$("#pop-up-search").toggle(false);$("#changePassSpan").toggle()}else if(e.id==="commViewMoreDesc"){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);$("#full-profile-data").toggle(false);$("#pop-up-search").toggle(false);if($("#commViewMoreDesc").html()==="view more..."){$("#commViewMoreDesc").html("Hide details")}else{$("#commViewMoreDesc").html("view more...")}$("#comdisplayMoreDesc").toggle()}else if(e.id.indexOf("post-new-comment-show")>=0){$("#pop-up-gossbag").toggle(false);$("#pop-up-message").toggle(false);$("#pop-up-user-actions").toggle(false);$("#pop-up-more").toggle(false);$("#full-profile-data").toggle(false);$("#pop-up-search").toggle(false);$("#pop-up-community-more").toggle(false);var n=e.id.lastIndexOf("-")+1;var r=e.id.substring(n);t={complete:function(){if($("#"+e.id).hasClass("Open")){if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("loadComment",{target:"#post-comments-"+r,user:readCookie("user_auth"),post_id:r,loadImage:true})}}},duration:0};if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open")}else{$("#"+e.id).addClass("Open")}$("#post-comments-"+r).toggle(t);$("#post-new-comment-"+r).toggle()}else if(e.id.indexOf("deletePost-")>=0||e.id.indexOf("deleteComment-")>=0){var n=e.id.lastIndexOf("-")+1;var r=e.id.substring(n);if(!$("#"+e.id).hasClass("clicked")){$("#"+e.id).addClass("clicked");if(e.id.indexOf("deleteComment-")>=0){r=e.id.substring(n).split("_");sendData("deleteComment",{target:"#comment-"+r[0],cid:r[0],postId:r[1]})}else if(e.id.indexOf("deletePost-")>=0){sendData("deletePost",{target:"#post-"+r,post_id:r})}}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(e.id.indexOf("continue-")>=0){var n=e.id.lastIndexOf("-")+1;var r=e.id.substring(n);if($("#"+e.id).html()==="continue reading..."){$("#"+e.id).html("show less")}else{$("#"+e.id).html("continue reading...")}$("#continuereading-"+r).toggle()}else if(e.id==="joinleave"||e.id.indexOf("joinCom-")>=0){if(e.id.indexOf("joinCom-")>=0){var i=e.id.lastIndexOf("-")+1;var s=e.id.substring(i);var o=$("#comUnique-"+s).html();var u=$("#comUnique-"+s).attr("rel");if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("leaveJoinCommunity",{target:"",comid:s,param:"Join",comName:o,comHelve:u})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else{sendData("leaveJoinCommunity",{target:"",comid:$("#joinleave").attr("rel"),param:$("#joinleave-text").html()})}}else if(e.getAttribute("class").indexOf("unfriend")>=0){var a=e.getAttribute("friend_id");$(".unfriend-"+a).addClass("");if(!$(".unfriend-"+a).hasClass("loaded")){$(".unfriend-"+a).addClass("loaded");sendData("sendFriendRequest",{target:"#loadImage-"+a,user:a,param:$(".unfriend-"+a+"-text").html(),loadImage:true})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(e.id.indexOf("wink-")>=0){var f=e.id.lastIndexOf("-")+1;var a=e.id.substring(f);if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");if(e.id.indexOf("wink-text-")>=0||e.id.indexOf("wink-text-n-")>=0){sendData("sendFriendRequest",{target:"#loadImage-"+a,user:a,param:"wink",resp:true,loadImage:true})}else{sendData("sendFriendRequest",{target:"#loadImage-"+a,user:a,param:"wink",loadImage:true})}}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(e.id.indexOf("winkIgnore-text")>=0){var f=e.id.lastIndexOf("-")+1;var a=e.id.substring(f);if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");sendData("sendFriendRequest",{target:"#winkOption-"+a,user:a,param:"ignoreWink"})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(e.id.indexOf("accept-frq-text")>=0){var l=$("#"+e.id).html();if(l==="Accept"||l==='<span class="icon-16-checkmark"></span>Accept'){if(!$("#"+e.id).hasClass("clicked")){$("#"+e.id).addClass("clicked");var f=e.id.lastIndexOf("-")+1;var a=e.id.substring(f);sendData("sendFriendRequest",{target:"#"+e.id,user:a,param:"Accept Request",loadImage:true})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(l==="Unfriend"){if(!$("#"+e.id).hasClass("clicked")){$("#"+e.id).addClass("clicked");var f=e.id.lastIndexOf("-")+1;var a=e.id.substring(f);sendData("sendFriendRequest",{target:"#"+e.id,user:a,param:"Unfriend",loadImage:true})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}}else if(e.id.indexOf("frqIgnore-text-")>=0){var l=$("#"+e.id).html();if(!$("#"+e.id).hasClass("clicked")){$("#"+e.id).addClass("clicked");var f=e.id.lastIndexOf("-")+1;var a=e.id.substring(f);sendData("sendFriendRequest",{target:"#"+e.id,user:a,param:"Ignore",loadImage:true})}else{humane.log("Request sent already",{timeout:3e3,clickToClose:true,addnCls:"humane-error"})}}else if(e.id==="inviteMemBtn"){if($("#"+e.id).hasClass("Open")){$("#"+e.id).removeClass("Open")}else{$("#"+e.id).addClass("Open")}if($("#"+e.id).hasClass("Open")){if(!$("#"+e.id).hasClass("loaded")){$("#"+e.id).addClass("loaded");var s=$("#joinleave").attr("rel");sendData("inviteFriends",{target:"#toUserInput",loadImage:true,comId:s})}}}else if(e.id.indexOf("invitationIgnore-text")>=0||e.id.indexOf("invitation-text-")>=0){var f=e.id.lastIndexOf("-")+1;var c=e.id.substring(f);if(e.id.indexOf("invitationIgnore-text")>=0){sendData("acceptDeclineComInvitation",{target:"#invitationtarget",loadImage:true,comId:c,response:false})}else{sendData("acceptDeclineComInvitation",{target:"#invitationtarget",loadImage:true,comId:c,response:true})}}else if(e.id==="chatButton"){var h=$(".chatContainer").css("width")+"",p=10,d=$(".chatContainer").length,v=10,m=0,g=$(window).width();h=h.substring(0,h.length-2);m=h*d+v*d+p;if($(".chatContainer").length===0){$("#chatHolder").append('<div class="chatContainer" id="comChat_'+$("#"+e.id).attr("rel")+'"><div class="chatTopBar rounded"></div><div class="chatLineHolder" id="chatLineHolder_'+$("#"+e.id).attr("rel")+'"></div><div class="chatUsers rounded" id="chatUsers_'+$("#"+e.id).attr("rel")+'"></div>'+'<div class="chatBottomBar rounded" id="chatBottomBar_'+$("#"+e.id).attr("rel")+'"><div class="tip"></div>'+'<textarea class="chatText rounded" name="chatText"></textarea></div></div>');chat.init($("#"+e.id).attr("rel"),$("#"+e.id).attr("comname"),$("#"+e.id).attr("compix"));$(".chatContainer").show()}else{if($("#comChat_"+$("#"+e.id).attr("rel")).length>0){$("#comChat_"+$("#"+e.id).attr("rel")).focus()}else{$("#chatHolder").append('<div class="chatContainer" style="right:'+m+'px"><div class="chatTopBar rounded"></div><div class="chatLineHolder"></div><div class="chatUsers rounded"></div>'+'<div class="chatBottomBar rounded"><div class="tip"></div><form id="loginForm" method="post" action=""><input id="name" name="name" class="rounded" maxlength="16" />'+'<input id="email" name="email" class="rounded" /><input type="submit" class="blueButton" value="Login" /></form><form autocomplete="off" id="submitForm" method="post" action="">'+'<textarea class="chatText rounded" name="chatText"></textarea></form></div></div>');chat.init($("#"+e.id).attr("rel"),$("#"+e.id).attr("comname"),$("#"+e.id).attr("compix"));$(".chatContainer").show()}}$(".chatText").keydown(function(t){if(t.keyCode===13&&!t.shiftKey){if($.trim($(this).val())===""){$(this).val("");return}checkChatBoxInputKey(this,$("#"+e.id).attr("rel"),$("#"+e.id).attr("comname"),$("#"+e.id).attr("compix"),false)}})}else{}}function readCookie(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)===" ")i=i.substring(1,i.length);if(i.indexOf(t)===0)return i.substring(t.length,i.length)}return 0}function ScaleImage(e,t,n,r,i){var s={width:0,height:0,fScaleToTargetWidth:true};if(e<=0||t<=0||n<=0||r<=0){return s}var o=n;var u=t*n/e;var a=e*r/t;var f=r;var l=a>n;if(l){l=i}else{l=!i}if(l){s.width=Math.floor(o);s.height=Math.floor(u);s.fScaleToTargetWidth=true}else{s.width=Math.floor(a);s.height=Math.floor(f);s.fScaleToTargetWidth=false}s.targetleft=Math.floor((n-s.width)/2);s.targettop=Math.floor((r-s.height)/2);return s}function OnImageLoad(e){var t=e.currentTarget;var n=$(t).width();var r=$(t).height();var i=$(t).parent().width();var s=$(t).parent().height();var o=ScaleImage(n,r,i,s,false);t.width=o.width;t.height=o.height;$(t).css("left",o.targetleft);$(t).css("top",o.targettop)}function showImageName(e){var t=e.lastIndexOf("\\");var n=e.substring(t+1);return n}function br2nl(e){return e.replace(/<br\s\/?>/g,"\r")}function br2nl(e){return e.replace(/<br\s\/?>/g,"\r")}function nl2br(e,t){var n=t||typeof t==="undefined"?"<br />":"<br>";return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+n+"$2")}function linkify(e){var t,n,r,i;n=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;t=e.replace(n,'<a href="$1" target="_blank">$1</a>');r=/(^|[^\/])(www\.[\S]+(\b|$))/gim;t=t.replace(r,'$1<a href="http://$2" target="_blank">$2</a>');i=/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim;t=t.replace(i,'<a href="mailto:$1">$1</a>');return t}function checkChatBoxInputKey(e,t,n,r,i){var s=$(e).val();if($.trim($(e).val())===""){$(e).val(s);return}$(e).val("");if(s.length===0){return false}if(i)return false;i=true;var o="t"+Math.round(Math.random()*1e6),u={id:o,name:chat.data.name,gravatar:chat.data.gravatar,text:nl2br(s.replace(/</g,"<").replace(/>/g,">"))};data={chatText:s,comid:t};chat.addChatLine($.extend({},u),t,n,r);$.tzPOST("submitChat",data,function(e){i=false;$(".chatText").val("");$("div.chat-"+o).remove();u["id"]=e.insertID;chat.addChatLine($.extend({},u),t,n,r)});return false}function minimizeChatToggle(e){if($("#chatLineHolder_"+e).css("display")!=="none"){$("#chatLineHolder_"+e).hide();$("#chatUsers_"+e).hide();$("#chatBottomBar_"+e).hide()}else{$("#chatLineHolder_"+e).show();$("#chatUsers_"+e).show();$("#chatBottomBar_"+e).show()}}function logoutCommunityChat(e){if($("#comChat_"+e).length>0){$("#comChat_"+e).remove()}$.tzPOST("logout",{comid:e})}var chatBoxes=new Array;var chat={data:{lastID:0,noActivity:0},init:function(e,t,n){chat.data.jspAPI=$(".chatLineHolder").jScrollPane({verticalDragMinHeight:12,verticalDragMaxHeight:12}).data("jsp");var r=false;$("#loginForm").submit(function(){if(r)return false;r=true;$.tzPOST("login",$(this).serialize(),function(i){r=false;if(i.error){chat.displayError(i.error)}else chat.login(i.name,i.gravatar,e,t,n)});return false});$("#submitForm").submit(function(){var i=$(".chatText").val();if(i.length===0){return false}if(r)return false;r=true;var s="t"+Math.round(Math.random()*1e6),o={id:s,name:chat.data.name,gravatar:chat.data.gravatar,text:i.replace(/</g,"<").replace(/>/g,">")};chat.addChatLine($.extend({},o),e,t,n);$.tzPOST("submitChat",$(this).serialize(),function(i){r=false;$(".chatText").val("");$("div.chat-"+s).remove();o["id"]=i.insertID;chat.addChatLine($.extend({},o),e,t,n)});return false});$.tzGET("checkLogged",{comid:e},function(r){if(r.logged){chat.login(r.loggedAs.name,r.loggedAs.gravatar,e,t,n);$(".minimize_chat_"+e).on("click",function(){minimizeChatToggle(e)});$(".log_user_out").on("click",function(){logoutCommunityChat(e)})}});(function i(){chat.getChats(i,e)})();(function s(){chat.getUsers(s,e)})()},login:function(e,t,n,r,i){chat.data.name=e;chat.data.gravatar=t;$(".chatTopBar").html(chat.render("loginTopBar",chat.data,n,r,i));$("#loginForm").fadeOut(function(){$("#submitForm").fadeIn();$(".chatText").focus()})},render:function(e,t,n,r,i){var s=[];switch(e){case"loginTopBar":s=['<span><img src="',i,'" width="23" height="23" />','<span class="name">',r,'</span><span class="logoutButton rounded log_user_out" title="Close Chat">x</span>','<span class="logoutButton rounded minimize_chat_'+n+'" title="Minimize">-</span>'];break;case"chatLine":s=['<div class="chat chat-',t.id,' rounded"><span class="gravatar"><a href="user/',t.user_id,'"><img src="',t.gravatar,'" width="23" height="23" onload="this.style.visibility=\'visible\'" /></a>','</span><span class="author"><a href="user/',t.user_id,'">',t.name,'</a>:</span><br/><span class="text">',nl2br(t.text),'</span><span class="time timeago" title="',t.time,'">',t.time,"</span></div>"];break;case"user":s=['<div class="user" title="',t.name,'"><a href="user/',t.user_id,'"><img src="',t.gravatar,'" width="30" height="30" onload="this.style.visibility=\'visible\'" /></a></div>'];break}return s.join("")},addChatLine:function(e,t,n,r){var i=new Date;var s=chat.render("chatLine",e,t,n,r),o=$(".chatLineHolder .chat-"+e.id);if(o.length){o.remove()}if(!chat.data.lastID){$(".chatLineHolder p").remove()}if(e.id.toString().charAt(0)!="t"){var u=$(".chatLineHolder .chat-"+(+e.id-1));if(u.length){u.after(s)}else chat.data.jspAPI.getContentPane().append(s)}else chat.data.jspAPI.getContentPane().append(s);chat.data.jspAPI.reinitialise();chat.data.jspAPI.scrollToBottom(true);$(".timeago").timeago()},getChats:function(e,t,n,r){$.tzGET("getChats",{lastID:chat.data.lastID,comid:t},function(i){for(var s=0;s<i.chats.length;s++){chat.addChatLine(i.chats[s],t,n,r)}if(i.chats.length){chat.data.noActivity=0;chat.data.lastID=i.chats[s-1].id}else{chat.data.noActivity++}if(!chat.data.lastID){chat.data.jspAPI.getContentPane().html('<p class="noChats">No chats yet</p>')}var o=1e3;if(chat.data.noActivity>3){o=2e3}if(chat.data.noActivity>10){o=5e3}if(chat.data.noActivity>20){o=15e3}setTimeout(e,o)})},getUsers:function(e,t,n,r){$.tzGET("getUsers",{comid:t},function(i){var s=[];for(var o=0;o<i.users.length;o++){if(i.users[o]){s.push(chat.render("user",i.users[o],t,n,r))}}var u="";if(i.total<1){u="No one is online"}else{u=i.total+" "+" online"}s.push('<p class="count">'+u+"</p>");$(".chatUsers").html(s.join(""));setTimeout(e,15e3)})},displayError:function(e){var t=$("<div>",{id:"chatErrorMessage",html:e});t.click(function(){$(this).fadeOut(function(){$(this).remove()})});setTimeout(function(){t.click()},5e3);t.hide().appendTo("body").slideDown()}};$.tzPOST=function(e,t,n){$.post("ajax.php?action="+e,t,n,"json")};$.tzGET=function(e,t,n){$.get("ajax.php?action="+e,t,n,"json")}